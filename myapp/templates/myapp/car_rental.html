{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö-‡∏Ñ‡∏∑‡∏ô‡∏£‡∏ñ‡πÉ‡∏ô‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï</title>
</head>
<body>
    <h1>üöó ‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö-‡∏Ñ‡∏∑‡∏ô‡∏£‡∏ñ‡πÉ‡∏ô‡∏†‡∏π‡πÄ‡∏Å‡πá‡∏ï</h1>
    <pre>{{ locations }}</pre>

    <!-- üîç Debug -->
    <h3>üîç Debug locations:</h3>
    <pre>{{ locations }}</pre>  
    {% debug %} <!-- ‚úÖ ‡πÉ‡∏ä‡πâ debug ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤ context -->

    {% for location in locations %}
        <h3>{{ location.name }}</h3>
        <iframe
            width="600"
            height="450"
            style="border:0"
            loading="lazy"
            allowfullscreen
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps/embed/v1/place?key={{ google_maps_api_key }}&q={{ location.latitude }},{{ location.longitude }}">
        </iframe>
    {% empty %}
        <p>‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö-‡∏Ñ‡∏∑‡∏ô‡∏£‡∏ñ</p>
    {% endfor %}

    <select id="locationSelect" class="form-select">
        <option value="" selected>‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∏‡∏î‡∏£‡∏±‡∏ö-‡∏Ñ‡∏∑‡∏ô‡∏£‡∏ñ</option>
        {% for location in locations %}
            <option value="{{ location.latitude }},{{ location.longitude }}" 
                    data-lat="{{ location.latitude }}" 
                    data-lng="{{ location.longitude }}">
                {{ location.name }}
            </option>
        {% empty %}
            <option disabled>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏¥‡∏Å‡∏±‡∏î</option>
        {% endfor %}
    </select>
    
    
    <iframe
        id="mapFrame"
        width="600"
        height="450"
        style="border:0"
        loading="lazy"
        allowfullscreen
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key={{ google_maps_api_key }}&q=7.8804,98.3923">
    </iframe>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var locationSelect = document.getElementById("locationSelect");
            var mapFrame = document.getElementById("mapFrame");
            var apiKey = document.getElementById("mapContainer").getAttribute("data-api-key"); // ‡∏î‡∏∂‡∏á API Key
            
            locationSelect.addEventListener("change", function () {
                var selectedValue = this.value;
                console.log("üîç ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:", selectedValue); // ‡∏î‡∏π‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô Console
                if (selectedValue) {
                    mapFrame.src = `https://www.google.com/maps/embed/v1/place?key=${apiKey}&q=${selectedValue}`;
                }
            });
        });
    </script>
    
</body>
</html>
